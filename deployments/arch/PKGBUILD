# Maintainer: Your Name <email@example.com>
pkgname=oci-arm-provisioner
pkgver=0.2.0
pkgrel=1
pkgdesc="Automated OCI ARM Instance Provisioner (Go)"
arch=('x86_64' 'aarch64')
url="https://github.com/yourusername/oci-arm-provisioner"
license=('MIT')
depends=('glibc')
makedepends=('go')
source=("${pkgname}-${pkgver}.tar.gz") # Assuming release tarball
sha256sums=('SKIP')

build() {
    cd "$srcdir/$pkgname-$pkgver"
    export CGO_ENABLED=0
    go build -ldflags="-s -w" -o oci-arm-provisioner .
}

package() {
    cd "$srcdir/$pkgname-$pkgver"
    
    # Install Binary
    install -Dm755 oci-arm-provisioner "$pkgdir/usr/bin/oci-arm-provisioner"
    
    # Install Systemd Units
    install -Dm644 deployments/systemd/oci-arm-provisioner.service "$pkgdir/usr/lib/systemd/user/oci-arm-provisioner.service"
    install -Dm644 deployments/systemd/oci-arm-provisioner.timer "$pkgdir/usr/lib/systemd/user/oci-arm-provisioner.timer"
    
    # Install Config Example
    install -Dm644 config.yaml.example "$pkgdir/etc/oci-arm-provisioner/config.yaml.example"
    
    # Install License
    install -Dm644 LICENSE "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}
